# üöÄ –î–µ–ø–ª–æ–π –Ω–∞ AWS Lambda (–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞!)

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ **1 –º–∏–ª–ª–∏–æ–Ω –≤—ã–∑–æ–≤–æ–≤/–º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ** - –≤–∞—à –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ~720/–º–µ—Å—è—Ü (0.07%)
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞** - –Ω–∏–∫–∞–∫–∏—Ö —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ **Serverless** - –Ω–µ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**

---

## –ß–∞—Å—Ç—å 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ deployment package (10 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd C:\Users\annam\Documents\DeFi-RAG-Project\trading_alert_system

# –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è Lambda package
mkdir lambda_package
cd lambda_package

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r ../requirements_lambda.txt -t .
```

### –®–∞–≥ 2: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
cd ..

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –≤ lambda_package
xcopy /E /I src lambda_package\src
copy lambda_function.py lambda_package\
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ ZIP –∞—Ä—Ö–∏–≤

```bash
cd lambda_package

# –í Windows –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π ZIP
# –í—ã–¥–µ–ª–∏—Ç–µ –í–°–ï —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ lambda_package
# –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí –û—Ç–ø—Ä–∞–≤–∏—Ç—å ‚Üí –°–∂–∞—Ç–∞—è ZIP-–ø–∞–ø–∫–∞
# –ù–∞–∑–æ–≤–∏—Ç–µ: trading-alert-bot.zip
```

**–í–∞–∂–Ω–æ:** ZIP –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ñ–∞–π–ª—ã **–≤–Ω—É—Ç—Ä–∏** –∞—Ä—Ö–∏–≤–∞, –∞ –Ω–µ –ø–∞–ø–∫—É!

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
trading-alert-bot.zip
‚îú‚îÄ‚îÄ lambda_function.py
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ aiogram/
‚îú‚îÄ‚îÄ ccxt/
‚îî‚îÄ‚îÄ ... (–¥—Ä—É–≥–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
```

---

## –ß–∞—Å—Ç—å 2: –°–æ–∑–¥–∞–Ω–∏–µ Lambda —Ñ—É–Ω–∫—Ü–∏–∏ –≤ AWS (15 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –í–æ–π–¥–∏—Ç–µ –≤ AWS Console

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://aws.amazon.com
2. –ù–∞–∂–º–∏—Ç–µ **"Sign In to the Console"**
3. –ï—Å–ª–∏ –Ω–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ - —Å–æ–∑–¥–∞–π—Ç–µ (–Ω—É–∂–Ω–∞ –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞, –Ω–æ —Å–ø–∏—Å–∞–Ω–∏–π –Ω–µ –±—É–¥–µ—Ç)

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ Lambda

1. –í –ø–æ–∏—Å–∫–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ AWS Console –≤–≤–µ–¥–∏—Ç–µ **"Lambda"**
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ **AWS Lambda**
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω **us-east-1** (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é

1. –ù–∞–∂–º–∏—Ç–µ **"Create function"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Author from scratch"**
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Function name**: `trading-alert-bot`
   - **Runtime**: **Python 3.11** (–∏–ª–∏ –Ω–æ–≤–µ–µ)
   - **Architecture**: `x86_64`
4. –ù–∞–∂–º–∏—Ç–µ **"Create function"**

### –®–∞–≥ 4: –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥

1. –í —Ä–∞–∑–¥–µ–ª–µ **"Code source"** –Ω–∞–∂–º–∏—Ç–µ **"Upload from"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **".zip file"**
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ `trading-alert-bot.zip`
4. –ù–∞–∂–º–∏—Ç–µ **"Save"**

‚è≥ **–ü–æ–¥–æ–∂–¥–∏—Ç–µ** –ø–æ–∫–∞ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è (–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 1-2 –º–∏–Ω—É—Ç—ã)

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Configuration"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Environment variables"**
3. –ù–∞–∂–º–∏—Ç–µ **"Edit"**
4. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

| Key | Value |
|-----|-------|
| `TELEGRAM_BOT_TOKEN` | –í–∞—à —Ç–æ–∫–µ–Ω –æ—Ç @BotFather |
| `TELEGRAM_CHAT_ID` | `764547167` |
| `CHECK_INTERVAL_SECONDS` | `3600` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Lambda, –Ω–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) |
| `JSON_FILE_PATH` | `alerts.json` |

5. –ù–∞–∂–º–∏—Ç–µ **"Save"**

### –®–∞–≥ 6: –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç –∏ –ø–∞–º—è—Ç—å

1. –í **"Configuration"** ‚Üí **"General configuration"**
2. –ù–∞–∂–º–∏—Ç–µ **"Edit"**
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   - **Memory**: `512 MB`
   - **Timeout**: `1 min 0 sec`
4. –ù–∞–∂–º–∏—Ç–µ **"Save"**

---

## –ß–∞—Å—Ç—å 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä EventBridge

1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Function overview"**
2. –ù–∞–∂–º–∏—Ç–µ **"Add trigger"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"EventBridge (CloudWatch Events)"**
4. –í **"Rule"** –≤—ã–±–µ—Ä–∏—Ç–µ **"Create a new rule"**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - **Rule name**: `trading-alert-hourly`
   - **Rule type**: `Schedule expression`
   - **Schedule expression**: `rate(1 hour)` (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å)

**–î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:**
- `rate(30 minutes)` - –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- `rate(15 minutes)` - –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- `cron(0 * * * ? *)` - –∫–∞–∂–¥—ã–π —á–∞—Å –≤ 0 –º–∏–Ω—É—Ç

6. –ù–∞–∂–º–∏—Ç–µ **"Add"**

---

## –ß–∞—Å—Ç—å 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (5 –º–∏–Ω—É—Ç)

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

1. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–∂–º–∏—Ç–µ **"Test"**
2. –í **"Event name"** –≤–≤–µ–¥–∏—Ç–µ: `test-event`
3. –û—Å—Ç–∞–≤—å—Ç–µ JSON –∫–∞–∫ –µ—Å—Ç—å: `{}`
4. –ù–∞–∂–º–∏—Ç–µ **"Save"**
5. –ù–∞–∂–º–∏—Ç–µ **"Test"** —Å–Ω–æ–≤–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-30 —Å–µ–∫—É–Ω–¥
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ **"Execution results"**
3. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   Configuration loaded from environment variables
   Connected to 2 exchanges
   Telegram bot initialized successfully
   Starting new alert check cycle...
   ```

4. –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –ø–æ–∫–∞–∂–∏—Ç–µ –∏—Ö –º–Ω–µ!

---

## –ß–∞—Å—Ç—å 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **CloudWatch**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"Log groups"**
3. –ù–∞–π–¥–∏—Ç–µ `/aws/lambda/trading-alert-bot`
4. –¢–∞–º –≤—Å–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

### –û—Ç–∫–ª—é—á–∏—Ç—å/–≤–∫–ª—é—á–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **EventBridge** ‚Üí **Rules**
2. –ù–∞–π–¥–∏—Ç–µ `trading-alert-hourly`
3. –ö–ª–∏–∫–Ω–∏—Ç–µ **Disable** —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
4. –ö–ª–∏–∫–Ω–∏—Ç–µ **Enable** —á—Ç–æ–±—ã –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –±–æ—Ç:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–ª–µ—Ä—Ç—ã –∫–∞–∂–¥—ã–π —á–∞—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ CloudWatch

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞: `@trading_alert_anna_m_bot`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –°–æ–∑–¥–∞–π—Ç–µ –∞–ª–µ—Ä—Ç:
   ```
   /add_alert bybit BTCUSDT above 95000
   ```

**–í–∞–∂–Ω–æ:** –ê–ª–µ—Ä—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/tmp/alerts.json` –≤–Ω—É—Ç—Ä–∏ Lambda. –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω AWS —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

### –†–µ—à–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ 100% –Ω–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **S3** –≤–º–µ—Å—Ç–æ `/tmp`
- –ò–ª–∏ **DynamoDB**

–ù–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ `/tmp` —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!

---

## –°—Ç–æ–∏–º–æ—Å—Ç—å

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç (–Ω–∞–≤—Å–µ–≥–¥–∞):**
- 1 –º–ª–Ω –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü
- 400,000 GB-—Å–µ–∫—É–Ω–¥ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**–í–∞—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- ~720 –∑–∞–ø—É—Å–∫–æ–≤/–º–µ—Å—è—Ü (–∫–∞–∂–¥—ã–π —á–∞—Å)
- ~360 GB-—Å–µ–∫—É–Ω–¥ (512MB * 0.5 —Å–µ–∫ * 720)

**–ò—Ç–æ–≥–æ: 0.07% –ª–∏–º–∏—Ç–∞ = $0.00/–º–µ—Å—è—Ü** üéâ

---

## Troubleshooting

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ ZIP —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ –∫–æ—Ä–Ω–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `lambda_function.py` –≤ –∫–æ—Ä–Ω–µ ZIP

### –¢–∞–π–º–∞—É—Ç
- –£–≤–µ–ª–∏—á—å—Ç–µ Timeout –¥–æ 2-3 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∏—Ä–∂–∏ –æ—Ç–≤–µ—á–∞—é—Ç

### –ê–ª–µ—Ä—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `JSON_FILE_PATH` = `alerts.json`
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ CloudWatch

### Telegram –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `TELEGRAM_BOT_TOKEN`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ `/start` –±–æ—Ç—É

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å S3 –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–æ–≤** (–≤–º–µ—Å—Ç–æ /tmp)
2. **–î–æ–±–∞–≤–∏—Ç—å SNS –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö**
3. **–°–æ–∑–¥–∞—Ç—å CloudWatch Dashboard** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ù–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—É—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ! üöÄ
