# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install email-validator moto[dynamodb]
```

### 2. –ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
pytest tests/test_auth.py -v

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_auth.py::test_register_user -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest tests/test_auth.py --cov=src/services/auth_service --cov=src/models/user -v
```

### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å AWS credentials
python app_auth.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://localhost:7860`

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (Manual Testing)

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "Login / Register"
2. –í —Ä–∞–∑–¥–µ–ª–µ "Register New Account":
   - Username: `alice`
   - Password: `AlicePass123`
   - Email: `alice@example.com`
   - Full Name: `Alice Smith`
3. –ù–∞–∂–º–∏—Ç–µ "Register"
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚úÖ User 'alice' registered successfully! Please login."

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

1. –í —Ä–∞–∑–¥–µ–ª–µ "Login":
   - Username: `alice`
   - Password: `AlicePass123`
2. –ù–∞–∂–º–∏—Ç–µ "Login"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚úÖ Welcome, alice!"
4. –í–∫–ª–∞–¥–∫–∞ "Login / Register" –¥–æ–ª–∂–Ω–∞ —Å–∫—Ä—ã—Ç—å—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Create Signal"
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - Signal Name: `Alice's BTC Alert`
   - Exchange: `bybit`
   - Symbol: `BTCUSDT`
   - Condition: `above`
   - Target Price: `50000`
   - Notes: `Test signal for Alice`
3. –ù–∞–∂–º–∏—Ç–µ "Create Signal"
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚úÖ Signal created: Alice's BTC Alert"
5. –¢–∞–±–ª–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "My Signals"
2. –ù–∞–∂–º–∏—Ç–µ "Refresh"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–∏–≥–Ω–∞–ª—ã Alice

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–π –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ (–∏–ª–∏ Incognito mode)
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   - Username: `bob`
   - Password: `BobPass123`
3. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ Bob
4. –°–æ–∑–¥–∞–π—Ç–µ —Å–∏–≥–Ω–∞–ª –¥–ª—è Bob:
   - Signal Name: `Bob's ETH Alert`
   - Symbol: `ETHUSDT`
   - Target Price: `3000`
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: Bob –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π —Å–∏–≥–Ω–∞–ª, –Ω–µ –≤–∏–¥–∏—Ç —Å–∏–≥–Ω–∞–ª—ã Alice

### –°—Ü–µ–Ω–∞—Ä–∏–π 6: –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏:
   - Username: `alice`
   - Password: `WrongPassword`
2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚ùå Invalid username or password!"

### –°—Ü–µ–Ω–∞—Ä–∏–π 7: –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "Logout"
2. –ù–∞–∂–º–∏—Ç–µ "Logout"
3. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚úÖ Logged out successfully!"
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª
5. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚ùå Please login first!"

### –°—Ü–µ–Ω–∞—Ä–∏–π 8: –°–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å (–¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–∞–ª–∏—Ç—å—Å—è)

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è:
   - Username: `test`
   - Password: `weak`
2. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: "‚ùå Validation error: Password must be at least 8 characters"

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

#### ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- –î—É–±–ª–∏–∫–∞—Ç—ã username
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π (–¥–ª–∏–Ω–∞, uppercase, lowercase, digit)

#### ‚úÖ –í—Ö–æ–¥
- –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
- –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å
- –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

#### ‚úÖ –°–µ—Å—Å–∏–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏
- –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
- –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π

#### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π

#### ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
- –†–∞–∑–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
- –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
- –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 1. –•–µ—à–∏ –ø–∞—Ä–æ–ª–µ–π –≤ –±–∞–∑–µ

```python
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω—ã
user = await storage.get_user("alice")
print(user.password_hash)  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–µ—à, –Ω–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
assert len(user.password_hash) == 96  # 32 (salt) + 64 (SHA-256)
```

### 2. –†–∞–∑–Ω—ã–µ —Ö–µ—à–∏ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–∞—Ä–æ–ª–µ–π

```python
hash1 = auth_service.hash_password("SecurePass123")
hash2 = auth_service.hash_password("SecurePass123")
assert hash1 != hash2  # –†–∞–∑–Ω–∞—è —Å–æ–ª—å
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–æ–ª—è—Ü–∏–∏

```python
# Alice –Ω–µ –¥–æ–ª–∂–Ω–∞ –≤–∏–¥–µ—Ç—å —Å–∏–≥–Ω–∞–ª—ã Bob
alice_signals = [s for s in all_signals if s.user_id == "alice"]
assert all(s.user_id == "alice" for s in alice_signals)
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–∞—Å—Å–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```python
import asyncio
import time

async def test_bulk_register():
    start = time.time()

    tasks = []
    for i in range(100):
        user_create = UserCreate(
            username=f"user{i}",
            password="SecurePass123"
        )
        tasks.append(auth_service.register_user(user_create))

    results = await asyncio.gather(*tasks)

    end = time.time()
    print(f"–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ {len([r for r in results if r])} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ {end-start:.2f}s")
```

## Troubleshooting

### –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ moto
pip install "moto[dynamodb]" pytest-asyncio

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ pytest-asyncio —Ä–∞–±–æ—Ç–∞–µ—Ç
pytest --co tests/test_auth.py
```

### ImportError: No module named 'models'

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ src/ –≤ PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:${PWD}/src"
```

### AWS credentials error

```bash
# –¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç moto mock, –Ω–µ –Ω—É–∂–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ credentials
# –ù–æ –µ—Å–ª–∏ –æ—à–∏–±–∫–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ:
export AWS_ACCESS_KEY_ID=testing
export AWS_SECRET_ACCESS_KEY=testing
```

## –ì–æ—Ç–æ–≤–æ –∫ production?

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [x] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [x] –ü–∞—Ä–æ–ª–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è
- [x] –°–µ—Å—Å–∏–∏ –∏–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
- [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–¥–ª—è production)
- [ ] Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–¥–ª—è production)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Email –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] 2FA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Ç–µ—Å—Ç—ã: `pytest tests/test_auth.py -v`
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Web UI
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `AUTHENTICATION_GUIDE.md`
4. –ì–æ—Ç–æ–≤–æ –∫ –∫–æ–º–º–∏—Ç—É!

## –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
git add .
git commit -m "feat: Add authentication system with login, registration, and user isolation"
git push origin your-branch
```
