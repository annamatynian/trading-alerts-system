# ‚úÖ –ì–û–¢–û–í–ù–û–°–¢–¨ –ö –î–ï–ü–õ–û–Æ - –ß–ï–ö–õ–ò–°–¢

## üìã **–¢–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç: –ú–û–ù–û–õ–ò–¢ (lambda_function.py)**

### ‚úÖ **–ß—Ç–æ –≥–æ—Ç–æ–≤–æ:**

#### **1. –ö–æ–¥:**
- ‚úÖ `lambda_function.py` - –º–æ–Ω–æ–ª–∏—Ç–Ω–∞—è Lambda —Ñ—É–Ω–∫—Ü–∏—è
- ‚úÖ `src/` - –≤–µ—Å—å –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ `requirements_lambda.txt` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (chump —É–¥–∞–ª–µ–Ω)
- ‚úÖ TRUE ASYNC –≤ `dynamodb_storage.py`
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è (signals/alerts)
- ‚úÖ **DynamoDB –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)**

#### **2. –¢–µ—Å—Ç—ã:**
- ‚úÖ 7/7 —Ç–µ—Å—Ç–æ–≤ DynamoDB –ø—Ä–æ—à–ª–∏
- ‚úÖ `conftest.py` —Å–æ–∑–¥–∞–Ω
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

#### **3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- ‚úÖ `DEPLOY_AWS_LAMBDA.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–µ–ø–ª–æ—è
- ‚úÖ `README.md` - –æ–±–Ω–æ–≤–ª–µ–Ω

#### **4. –ë—É–¥—É—â–µ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ `lambda_reader.py` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è Fan-Out
- ‚úÖ `lambda_worker.py` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è Fan-Out  
- ‚úÖ `DEPLOY_FAN_OUT.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Fan-Out

---

## üöÄ **–ß–¢–û –î–ï–ü–õ–û–ò–ú –°–ï–ô–ß–ê–°:**

### **–ú–æ–Ω–æ–ª–∏—Ç - lambda_function.py**

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
CloudWatch Events (–∫–∞–∂–¥—ã–π —á–∞—Å)
        ‚Üì
Lambda Function
        ‚Üì
  Google Sheets (–∏—Å—Ç–æ—á–Ω–∏–∫) ‚Üí DynamoDB (—Å–æ—Å—Ç–æ—è–Ω–∏–µ) ‚Üí Binance/Coinbase ‚Üí Pushover
```

**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~$0.002/–º–µ—Å—è—Ü (0.2 —Ü–µ–Ω—Ç–∞) üíµ

**–ü–æ—á–µ–º—É –Ω—É–∂–Ω–∞ DynamoDB:**
- ‚úÖ –•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ (triggered_count, active)
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –ë–µ–∑ DynamoDB = –∞–ª–µ—Ä—Ç –∫–∞–∂–¥—ã–π —á–∞—Å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ!

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ (–Ω–µ—Ç —Å–ø–∞–º–∞)
- ‚úÖ –ü–æ—á—Ç–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ ($0.002/–º–µ—Å)
- ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è < 100 —Å–∏–≥–Ω–∞–ª–æ–≤

---

## üì¶ **–°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì: –°–æ–∑–¥–∞–Ω–∏–µ Deployment Package**

### **–®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª**
```bash
cd C:\Users\annam\Documents\DeFi-RAG-Project\trading_alert_system
```

### **–®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è package**
```bash
mkdir lambda_package
cd lambda_package
```

### **–®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**
```bash
pip install -r ..\requirements_lambda.txt -t .
```

### **–®–∞–≥ 4: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥**
```bash
xcopy /E /I ..\src src
copy ..\lambda_function.py .
```

### **–®–∞–≥ 5: –°–æ–∑–¥–∞–π—Ç–µ ZIP**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–ø–∫—É `lambda_package` –≤ –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–µ
2. –í—ã–¥–µ–ª–∏—Ç–µ **–í–°–ï —Ñ–∞–π–ª—ã** (Ctrl+A)
3. –ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí **–û—Ç–ø—Ä–∞–≤–∏—Ç—å** ‚Üí **–°–∂–∞—Ç–∞—è ZIP-–ø–∞–ø–∫–∞**
4. –ù–∞–∑–æ–≤–∏—Ç–µ: `trading-signals-lambda.zip`

---

## ‚öôÔ∏è **–ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø (–¥–ª—è Lambda):**

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ ZIP –≤ AWS Lambda, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|-----------|----------|-------------|
| `GOOGLE_SHEETS_SPREADSHEET_ID` | ID –≤–∞—à–µ–π —Ç–∞–±–ª–∏—Ü—ã | ‚úÖ |
| `GOOGLE_SERVICE_ACCOUNT_JSON` | JSON –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ | ‚úÖ |
| `TRADING_ALERT_PUSHOVER_API_TOKEN` | Pushover API token | ‚úÖ |
| `DYNAMODB_TABLE_NAME` | `trading-signals` | ‚úÖ **(–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)** |
| `BINANCE_API_KEY` | –ö–ª—é—á Binance | ‚ùå (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `BINANCE_API_SECRET` | –°–µ–∫—Ä–µ—Ç Binance | ‚ùå (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `COINBASE_API_KEY` | –ö–ª—é—á Coinbase | ‚ùå (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| `COINBASE_API_SECRET` | –°–µ–∫—Ä–µ—Ç Coinbase | ‚ùå (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

---

## üìù **–ù–ê–°–¢–†–û–ô–ö–ò AWS LAMBDA:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **Runtime** | Python 3.11 |
| **Handler** | `lambda_function.lambda_handler` |
| **Memory** | 512 MB |
| **Timeout** | 1 min |
| **IAM Role** | Custom (—Å–º. –Ω–∏–∂–µ) |

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û - Custom IAM Policies (–ü—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π):**

1. **–ë–∞–∑–æ–≤–∞—è Lambda —Ä–æ–ª—å:**
   - `AWSLambdaBasicExecutionRole` (CloudWatch Logs)

2. **DynamoDB –¥–æ—Å—Ç—É–ø (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!):**
   - –°–æ–∑–¥–∞–π—Ç–µ custom policy –∏–∑ —Ñ–∞–π–ª–∞ `iam_policy_dynamodb.json`
   - –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ `trading-signals`
   - ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `AmazonDynamoDBFullAccess` (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!)

3. **Secrets Manager –¥–æ—Å—Ç—É–ø (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø):**
   - –°–æ–∑–¥–∞–π—Ç–µ custom policy –∏–∑ —Ñ–∞–π–ª–∞ `iam_policy_secrets.json`
   - –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–∞

---

## ‚è∞ **–¢–†–ò–ì–ì–ï–† CloudWatch:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **Rule name** | `trading-signals-hourly` |
| **Schedule expression** | `rate(1 hour)` |

**–î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**
- `rate(30 minutes)` - –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
- `rate(15 minutes)` - –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- `cron(0 * * * ? *)` - –∫–∞–∂–¥—ã–π —á–∞—Å –≤ 0 –º–∏–Ω—É—Ç

---

## üéØ **–ú–ò–ì–†–ê–¶–ò–Ø –ù–ê FAN-OUT (–í –ë–£–î–£–©–ï–ú):**

–ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤—ã—Ä–∞—Å—Ç–µ—Ç > 100:

1. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ `DEPLOY_FAN_OUT.md`
2. –°–æ–∑–¥–∞–π—Ç–µ SQS –æ—á–µ—Ä–µ–¥—å
3. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ `lambda_reader.py`
4. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ `lambda_worker.py`
5. –°–æ–∑–¥–∞–π—Ç–µ DynamoDB —Ç–∞–±–ª–∏—Ü—É

**–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:** ~$0.21/–º–µ—Å—è—Ü

---

## ‚úÖ **–ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ!**

–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ AWS Lambda! üöÄ

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** 
–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ `DEPLOY_AWS_LAMBDA.md`
